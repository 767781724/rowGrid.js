(function(b){b.fn.rowGrid=function(d){if(d==="appended"){d=this.data("grid-options");var e=this.children("."+d.lastRowClass);var c=e.nextAll().add(e);a(this,d,c)}else{d=b.extend({},b.fn.rowGrid.defaults,d);var f=this;f.data("grid-options",d);a(f,d);if(d.resize){b(window).on("resize",{container:f},function(g){a(g.data.container,d)})}}return this};b.fn.rowGrid.defaults={minMargin:null,maxMargin:null,resize:true,lastRowClass:"last-row",firstItemClass:null};function a(j,e,d){var c=0,i=[],d=d||j.children(e.itemSelector),h=d.length-1;j.children("."+e.lastRowClass).removeClass(e.lastRowClass);d.removeAttr("style").removeClass(e.firstItemClass);var g=j.width()-(j[0].offsetWidth-j[0].clientWidth);var f=[];d.each(function(k,l){l=b(l);f[k]={outerWidth:l.outerWidth(),height:l.height()}});d.each(function(r,m){m=b(m);c+=f[r].outerWidth;i.push(m);if(r===h){for(var t=0;t<i.length;t++){if(t===0){i[t].addClass(e.lastRowClass)}i[t].css("margin-right",(t<i.length-1)?e.minMargin:0)}}if(c+e.maxMargin*(i.length-1)>g){var u=c+e.maxMargin*(i.length-1)-g;var v=i.length;var q=(e.maxMargin-e.minMargin)*(v-1);if(q<u){var p=e.minMargin;u-=(e.maxMargin-e.minMargin)*(v-1)}else{var p=e.maxMargin-u/(v-1);u=0}var s,o=0;for(var t=0;t<i.length;t++){s=i[t];var l=f[r+parseInt(t)-i.length+1].outerWidth;var n=l-(l/c)*u;var k=Math.round(f[r+parseInt(t)-i.length+1].height*(n/l));if(o+1-n%1>=0.5){o-=n%1;n=Math.floor(n)}else{o+=1-n%1;n=Math.ceil(n)}s.css("width",n).css("height",k).css("margin-right",(t<i.length-1)?p:0);if(t===0){s.addClass(e.firstItemClass)}}i=[],c=0}})}})(jQuery);