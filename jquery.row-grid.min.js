(function(b){b.fn.rowGrid=function(d){if(d==="appended"){d=this.data("grid-options");var e=this.children("."+d.lastRowClass);var c=e.nextAll().add(e);a(this,d,c)}else{d=b.extend({},b.fn.rowGrid.defaults,d);var f=this;f.data("grid-options",d);a(f,d);if(d.resize){b(window).on("resize",{container:f},function(g){a(g.data.container,d)})}}return this};b.fn.rowGrid.defaults={minMargin:null,maxMargin:null,resize:true,lastRowClass:"last-row",firstItemClass:null};function a(j,e,d){var c=0,i=[],d=d||j.children(e.itemSelector),h=d.length-1;j.children("."+e.lastRowClass).removeClass(e.lastRowClass);d.removeAttr("style").removeClass(e.firstItemClass);var g=j.width()-(j[0].offsetWidth-j[0].clientWidth);var f=[];d.each(function(k,l){l=b(l);f[k]={outerWidth:l.outerWidth(),height:l.height()}});d.each(function(p,l){l=b(l);c+=f[p].outerWidth;i.push(l);if(p===h){for(var r=0;r<i.length;r++){if(r===0){i[r].addClass(e.lastRowClass)}i[r].css("margin-right",(r<i.length-1)?e.minMargin:0)}}if(c+e.maxMargin*(i.length-1)>g){var s=c+e.maxMargin*(i.length-1)-g;var t=i.length;var o=(e.maxMargin-e.minMargin)*(t-1);if(o<s){var n=e.minMargin;s-=(e.maxMargin-e.minMargin)*(t-1)}else{var n=e.maxMargin-s/(t-1);s=0}var q;for(var r=0;r<i.length;r++){q=i[r];var k=f[p+parseInt(r)-i.length+1].outerWidth;var m=k-(k/c)*s;q.css("width",m).css("height",f[p+parseInt(r)-i.length+1].height*(m/k)).css("margin-right",(r<i.length-1)?n:0);if(r===0){q.addClass(e.firstItemClass)}}i=[];c=0}})}})(jQuery);